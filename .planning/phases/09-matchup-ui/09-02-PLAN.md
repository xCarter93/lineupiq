---
phase: 09-matchup-ui
plan: 02
type: execute
wave: 2
depends_on: ["09-01"]
files_modified:
  - packages/frontend/components/matchup/TeamSelect.tsx
  - packages/frontend/lib/prediction-api.ts
  - packages/frontend/components/matchup/MatchupForm.tsx
  - packages/frontend/app/matchup/page.tsx
autonomous: true
---

<objective>
Create opponent selection and prediction API client for matchup configuration.

Purpose: Allow users to select opponent team and configure matchup parameters (week/season), then fetch predictions from Python API.
Output: TeamSelect component, prediction API client service, MatchupForm component.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan provides PlayerSelect and matchup page
@.planning/phases/09-matchup-ui/09-01-SUMMARY.md

# Python API prediction schemas (17 features required)
@packages/backend/src/lineupiq/api/schemas/prediction.py

# Convex hooks for storing predictions
@packages/frontend/hooks/usePredictions.ts
@packages/frontend/hooks/useScoringConfigs.ts

# Shadcn UI components
@packages/frontend/components/ui/select.tsx
@packages/frontend/components/ui/input.tsx
@packages/frontend/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TeamSelect component</name>
  <files>packages/frontend/components/matchup/TeamSelect.tsx</files>
  <action>
Create a dropdown for selecting NFL opponent team.

Props:
- `value: string | null` - selected team abbreviation
- `onSelect: (team: string) => void` - callback when team selected
- `placeholder?: string` - placeholder text (default: "Select opponent...")

Implementation:
- Use Shadcn Select component
- Hardcode NFL team list (32 teams) with abbreviation and full name
- Group teams by division (AFC East, AFC North, etc.) using SelectGroup
- Display as "Team Name (ABB)" format
- Team data as const array: { abbr: string, name: string, division: string }

NFL Teams (organize by division):
AFC East: BUF, MIA, NE, NYJ
AFC North: BAL, CIN, CLE, PIT
AFC South: HOU, IND, JAX, TEN
AFC West: DEN, KC, LV, LAC
NFC East: DAL, NYG, PHI, WAS
NFC North: CHI, DET, GB, MIN
NFC South: ATL, CAR, NO, TB
NFC West: ARI, LAR, SEA, SF

Export NFL_TEAMS constant for reuse.
  </action>
  <verify>File exists and exports TeamSelect component and NFL_TEAMS constant</verify>
  <done>TeamSelect renders dropdown with all 32 teams grouped by division, calls onSelect with team abbr</done>
</task>

<task type="auto">
  <name>Task 2: Create prediction API client</name>
  <files>packages/frontend/lib/prediction-api.ts</files>
  <action>
Create a client service for calling the Python prediction API.

Types:
```typescript
interface PredictionFeatures {
  passing_yards_roll3: number;
  passing_tds_roll3: number;
  rushing_yards_roll3: number;
  rushing_tds_roll3: number;
  carries_roll3: number;
  receiving_yards_roll3: number;
  receiving_tds_roll3: number;
  receptions_roll3: number;
  opp_pass_defense_strength: number;
  opp_rush_defense_strength: number;
  opp_pass_yards_allowed_rank: number;
  opp_rush_yards_allowed_rank: number;
  opp_total_yards_allowed_rank: number;
  temp_normalized: number;
  wind_normalized: number;
  is_home: boolean;
  is_dome: boolean;
}

interface QBPrediction { passing_yards: number; passing_tds: number; }
interface RBPrediction { rushing_yards: number; rushing_tds: number; carries: number; receiving_yards: number; receptions: number; }
interface ReceiverPrediction { receiving_yards: number; receiving_tds: number; receptions: number; }
```

Functions:
- `predictQB(features: PredictionFeatures): Promise<QBPrediction>`
- `predictRB(features: PredictionFeatures): Promise<RBPrediction>`
- `predictWR(features: PredictionFeatures): Promise<ReceiverPrediction>`
- `predictTE(features: PredictionFeatures): Promise<ReceiverPrediction>`
- `predict(position: string, features: PredictionFeatures): Promise<QBPrediction | RBPrediction | ReceiverPrediction>`

Implementation:
- Use fetch to POST to `${API_BASE_URL}/predict/{position}`
- API_BASE_URL from env var NEXT_PUBLIC_PREDICTION_API_URL (default: "http://localhost:8000")
- Set Content-Type: application/json header
- Throw error on non-ok response with status and message
- Export types and functions

Note: For v1, we'll use mock/default features. Real feature calculation would require historical data lookup.
  </action>
  <verify>File exists and exports predict function and all types</verify>
  <done>prediction-api.ts exports typed functions for calling Python prediction endpoints</done>
</task>

<task type="auto">
  <name>Task 3: Create MatchupForm component and integrate into page</name>
  <files>packages/frontend/components/matchup/MatchupForm.tsx, packages/frontend/app/matchup/page.tsx</files>
  <action>
Create MatchupForm that combines player selection, opponent selection, and week/season inputs.

MatchupForm Props:
- `onSubmit: (matchup: MatchupData) => void` - callback when form submitted
- `isLoading?: boolean` - disable form while predicting

MatchupData type:
```typescript
interface MatchupData {
  playerId: string;
  playerName: string;
  position: string;
  team: string;
  opponentTeam: string;
  week: number;
  season: number;
  isHome: boolean;
}
```

MatchupForm Implementation:
- Import and use PlayerSelect (with internal position filter)
- Import and use TeamSelect for opponent
- Week input (number 1-18)
- Season input (number, default current year)
- Home/Away toggle (checkbox or switch)
- Submit button "Get Prediction"
- Disable submit until player and opponent selected
- Use Card with CardHeader "Configure Matchup" and CardContent

Update matchup/page.tsx:
- Replace current content with MatchupForm
- Add state for matchup result (null initially)
- onSubmit handler that logs matchup data (prediction display comes in 09-03)
- Show "Matchup configured: {playerName} vs {opponentTeam}" after submit
  </action>
  <verify>pnpm build succeeds, matchup page shows complete form</verify>
  <done>MatchupForm combines all selection components, page handles form submission</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm build` in packages/frontend succeeds without errors
- [ ] TeamSelect shows all 32 teams grouped by division
- [ ] prediction-api.ts compiles without TypeScript errors
- [ ] MatchupForm renders with all inputs and submit button
- [ ] Submit button disabled until player and opponent selected
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Matchup configuration form complete and functional
</success_criteria>

<output>
After completion, create `.planning/phases/09-matchup-ui/09-02-SUMMARY.md`
</output>
