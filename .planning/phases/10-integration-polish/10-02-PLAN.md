---
phase: 10-integration-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/frontend/components/matchup/PlayerSelect.tsx
  - packages/frontend/lib/prediction-api.ts
  - packages/frontend/components/matchup/MatchupForm.tsx
autonomous: true
---

<objective>
Add comprehensive error handling and loading states for edge cases throughout the matchup flow.

Purpose: Improve user experience when things go wrong (API down, no players, network issues).
Output: Robust error states and loading indicators.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Source files
@packages/frontend/components/matchup/PlayerSelect.tsx
@packages/frontend/components/matchup/MatchupForm.tsx
@packages/frontend/lib/prediction-api.ts
@packages/frontend/app/matchup/page.tsx
@packages/frontend/hooks/usePlayers.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add empty state to PlayerSelect</name>
  <files>packages/frontend/components/matchup/PlayerSelect.tsx</files>
  <action>
    Improve PlayerSelect to handle no players:
    - When usePlayers returns empty array, show helpful empty state
    - Message: "No players available" with hint about seeding
    - Show loading spinner while players are loading (use isLoading from hook)
    - Keep existing combobox functionality for populated state
    - Use Loader2 icon from lucide-react for loading state
    - Style empty state with muted-foreground text color
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>PlayerSelect shows loading state while fetching and helpful message when no players exist</done>
</task>

<task type="auto">
  <name>Task 2: Improve prediction API error handling</name>
  <files>packages/frontend/lib/prediction-api.ts</files>
  <action>
    Enhance error handling in makePredictionRequest:
    - Detect network errors (fetch failed) vs API errors (4xx/5xx)
    - For network errors: throw with message "Could not connect to prediction API"
    - For 4xx errors: include response body in error message
    - For 5xx errors: throw with message "Prediction service error"
    - Add timeout of 10 seconds using AbortController
    - On timeout: throw with message "Prediction request timed out"
    - Keep existing function signatures unchanged
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>Prediction API client has specific error types for different failure modes</done>
</task>

<task type="auto">
  <name>Task 3: Add loading skeletons to MatchupForm</name>
  <files>packages/frontend/components/matchup/MatchupForm.tsx</files>
  <action>
    Add subtle loading states:
    - Add disabled state to form when prediction is loading (already exists via isLoading)
    - Disable all inputs while loading to prevent double-submission
    - Ensure button loading state shows spinner (already implemented)
    - Add aria-busy="true" to form when loading for accessibility
    - Keep existing form structure and styling
    - DO NOT add skeleton components - just ensure disabled states work correctly
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>Form inputs are properly disabled during loading with accessible aria states</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm build` in packages/frontend succeeds
- [ ] PlayerSelect shows loading spinner while fetching players
- [ ] PlayerSelect shows empty message when no players exist
- [ ] API errors show specific error messages (not generic "Failed")
- [ ] Form is disabled during prediction loading
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Error states are informative and actionable
- Loading states provide clear feedback
</success_criteria>

<output>
After completion, create `.planning/phases/10-integration-polish/10-02-SUMMARY.md`
</output>
